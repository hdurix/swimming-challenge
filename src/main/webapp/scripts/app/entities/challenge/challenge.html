<div>
    <div class="row">
        <div class="col-md-10">
            <h3 style="margin-top:2px;">R√©servation de cr√©neaux pour la journ√©e D√©fi "Je marche ou je cours" du 27 mai 2018</h3>
        </div>
        <div class="col-md-2" ng-if="vm.connected">
            <span class="badge badge-reserved" data-tooltip="Cr√©neaux r√©serv√©s">{{vm.user.nbReserved}}</span>
            <span class="badge badge-payed" data-tooltip="Cr√©neaux pay√©s">{{vm.user.nbPayed}}</span>
            <button type="button" class="btn btn-info" ui-sref="print" ng-disabled="!vm.user.nbReserved"
                    data-tooltip="Impression de votre coupon r√©servation">
                Imprimer&nbsp;<span class="glyphicon glyphicon-print"></span>
            </button>
        </div>
    </div>
    <p>Ci-dessous se trouve le planning du d√©fi "Je marche ou je cours" pour le
        <a href="http://www.defi-anthony.org/" target="_blank">D√©fi Anthony</a>.
    </p>

    <div class="bs-callout bs-callout-success">
        <div>
            <span class="main-rule">1- R√©servez un cr√©neau pour votre √©quipe</span> : cliquez sur un cr√©neau disponible
            pour cr√©er une nouvelle r√©servation (bleu).
        </div>
        <div>
            <span class="main-rule">2- Validez votre inscription</span> : imprimez votre coupon puis
            envoyez-le √† l‚Äôadresse indiqu√©e accompagn√© de votre r√®glement, dans un d√©lai de 8 jours.
        </div>
        <div>
            <span class="main-rule">3- Pour plus de d√©tails</span> : cliquez dans le premier encadr√© ci-dessous.
        </div>
        <div>
            <span class="main-rule">4- Pour le r√®glement complet</span> : cliquez dans le deuxi√®me encadr√© ci-dessous.
        </div>
    </div>

    <p>
        Nous vous remercions pour votre participation et vous attendons nombreux le 27 mai pour une tr√®s belle journ√©e !
    </p>

    <div class="panel-group">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" href="#collapse1">Pour plus de renseignement, cliquez ici</a>
                </h4>
            </div>
            <div id="collapse1" class="panel-collapse collapse">
                <div class="panel-body">

                    <p>Le D√©fi Anthony (antenne de Chauffailles) organise un d√©fi "Je marche ou je cours"
                        le <b>27 mai 2018</b> √† partir de <b>8h</b> au plan d'eau de Belmont-de-la-Loire.</p>

                    <p>100% de l‚Äôargent collect√© lors de cette journ√©e sera revers√© √† l‚Äôassociation
                        <a href="http://www.defi-anthony.org/" target="_blank">D√©fi Anthony</a> qui collecte des fonds
                        pour la lutte contre la leuc√©mie.</p>

                    <div class="bs-callout bs-callout-info">
                        Notre d√©fi "Je marche ou je cours" consistera √† additionner tous les kilom√®tres qui seront parcourus lors de la
                        journ√©e du 27 mai 2018 afin d‚Äôobtenir la plus grande distance possible : 500, 700, 1000, ... 2000km ???
                        <br>
                        Ainsi, toutes les 15 minutes, des marcheurs/coureurs, seuls ou en √©quipe (maximum 5 personnes) prendront le
                        d√©part pour parcourir 2km.
                    </div>

                    <p>Toute personne qui le souhaite peut participer afin qu‚Äôun maximum de
                        kilom√®tres soient parcourus ce soir-l√†. Peu importe la vitesse, l‚Äôessentiel √©tant de
                        participer afin d‚Äôapporter une aide pr√©cieuse √† la recherche contre la leuc√©mie.</p>

                    <p>Mais, si vous ne voulez participer directement √† cette marche/course, vous pouvez vous aussi <b>contribuer √† la r√©ussite</b>
                        de ce d√©fi en constituant une √©quipe qui partipera pour vous ; vous serez alors le <b>parrain</b> de cette
                        √©quipe et vous paierez l‚Äôinscription √† sa place.</p>

                    Pour participer, il suffit donc :
                    <ul>
                        <li>de courir/marcher 15 minutes seul</li>
                        <li>de courir/marcher en √©quipe (5 coureurs/marcheurs max) pendant 15 minutes en d√©signant un capitaine.</li>
                        <li>de parrainer une √©quipe (de 1 √† 5 coureurs/marcheurs) et de payer l‚Äôinscription √† sa place.</li>
                    </ul>

                    <p>L‚Äôinscription, pour un cr√©neau de 15 minutes, co√ªte 10 ‚Ç¨, enti√®rement revers√©s √† la <b>recherche contre la
                        leuc√©mie</b> par l‚Äôinterm√©diaire de l‚ÄôAssociation <i>D√©fi Anthony</i>.</p>

                    <div class="bs-callout bs-callout-success">
                        Pour une bonne organisation, nous vous demandons si possible, de vous inscrire ou d‚Äôinscrire une
                        √©quipe √† l‚Äôavance ce qui vous permettra de choisir le cr√©neau-horaire.
                        <br>Vous pouvez le faire directement sur ce site en <b>r√©servant un cr√©neau</b>. Les cr√©neaux disponibles
                        sont color√©s bleu. Il est possible de r√©server un cr√©neau en cliquant dessus (apr√®s cr√©ation
                        d'un compte).
                    </div>

                    <p>L‚Äôinscription ne sera d√©finitive que lorsque le parrain ou le capitaine de l‚Äô√©quipe aura fait
                        parvenir le r√®glement correspondant √† l‚Äôinscription soit au salon Evolu‚Äôtifs, soit chez madame
                        Anne Luccioni. R√®glement uniquement par ch√®que √† l‚Äôordre de l‚ÄôAssociation <i>D√©fi Anthony</i>.</p>

                    <div class="bs-callout bs-callout-info">
                        Vous avez aussi la possibilit√© de r√©server des plateaux-repas qui seront servis le
                        <b>27 mai</b> √† partir de 11h constitu√©s d‚Äôune entr√©e (mac√©doine de l√©gumes), d‚Äôune tranche de r√¥ti avec
                        des chips, d‚Äôune portion de fromage et d‚Äôune part de tarte aux pommes (possibilit√© de remplacer
                        la tranche de r√¥ti par un morceau de poulet).
                    </div>
                    <p>
                        La r√©servation finale de ces cr√©neaux ne sera effective qu'apr√®s r√©ception du r√®glement.
                        Pour cela, vous pouvez imprimer votre bulletin d'inscription en cliquant sur le bouton
                        en haut √† droite
                        <button class="btn btn-xs btn-info">
                            Imprimer&nbsp;<span class="glyphicon glyphicon-print"></span>
                        </button>. Les organisateurs de cette journ√©e annuleront cette r√©servation
                        si aucun r√®glement n'est re√ßu sous 8 jours.
                    </p>
                </div>
            </div>
        </div>
        <div class="panel panel-warning">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" href="#collapse2">Pour consulter le r√®glement complet, cliquez ici</a>
                </h4>
            </div>
            <div id="collapse2" class="panel-collapse collapse">
                <div class="panel-body">
                    <h4><strong>ARTICLE 1 ‚Äì LE DEFI</strong></h4>
                    <p>
                        Le d√©fi est un √©v√©nement sportif, non comp√©titif (pas de chronom√®tre, pas de classement de temps).
                    </p>
                    <p>
                        Tous ensemble, additionnons nos distances pour aller le plus loin possible (1000, 2000 ‚Ä¶.3500 km)
                    </p>

                    <h4><strong>ARTICLE 2 ‚Äì ORGANISATEUR</strong></h4>
                    <p>
                        LE DEFI est organis√© par : DEFI ANTHONY ‚Äì Mont Talon ‚Äì 71800 ST SYMPHORIEN DES BOIS
                    </p>

                    <h4><strong>ARTICLE 3 ‚Äì PARCOURS</strong></h4>
                    <p>
                        L‚Äô√©v√©nement se r√©alise en marchant ou en courant sur 10km en individuel ou en √©quipe. Le parcours est un circuit de 2km sur le site du Plan d‚Äôeau de Belmont de la Loire (42670). Il est √† faire 5 fois.
                    </p>

                    <h4><strong>ARTICLE 4 ‚Äì CONDITIONS DE PARTICIPATION</strong></h4>
                    <p>
                        Le parcours de 10km est ouvert √† tous les participants sans limite d‚Äô√¢ge. Il est de la responsabilit√© de chaque participant de s‚Äôinscrire sur une distance qui correspond √† ses capacit√©s.
                    </p>
                    <p>
                        Il est express√©ment indiqu√© que les personnes inscrites participent √† l‚Äô√©v√©nement sous leur propre et exclusive responsabilit√©. Les participants d√©clarent avoir les conditions physiques et m√©dicales suffisantes et appropri√©es pour marcher ou courir √† l‚Äôallure de leur choix sur la distance choisie, non chronom√©tr√©e. Il en est de la responsabilit√© du capitaine ou parrain de s‚Äôen assurer pour l‚Äôengagement de son √©quipe.
                    </p>

                    <h4><strong>ARTICLE 5 - JOUR DE L‚Äô√âV√àNEMENT</strong></h4>
                    <p>
                        Les participants sont tenus de respecter le site pendant et apr√®s l‚Äô√©v√®nement.
                    </p>

                    <h4><strong>ARTICLE 6 ‚Äì ASSURANCES</strong></h4>
                    <p>
                        L‚Äôorganisateur est couvert par la police d‚Äôassurance. Il incombe aux participants de s‚Äôassurer personnellement.
                    </p>

                    <h4><strong>ARTICLE 7 ‚Äì DOMMAGE MAT√âRIEL</strong></h4>
                    <p>
                        L‚Äôorganisateur d√©cline toute responsabilit√© en cas de dommages (vol, bris, perte‚Ä¶) subis par les biens personnels des participants, ce m√™me s‚Äôil en a la garde. Les participants ne pourront donc se retourner contre l‚Äôorganisateur pour tout dommage caus√© √† leur √©quipement. La souscription d‚Äôune assurance garantissant ces risques est du ressort de chacun.
                    </p>

                    <h4><strong>ARTICLE 8 ‚Äì ANNULATION</strong></h4>
                    <p>
                        En cas de conditions m√©t√©orologiques trop d√©favorables (importantes quantit√©s de pluie, fort risque orageux‚Ä¶,) le d√©part peut √™tre report√© de 2 heures au maximum ; au-del√†, l‚Äô√©v√©nement est annul√©e.
                    </p>
                    <p>
                        En cas de force majeure (en particulier en cas de mauvaises conditions m√©t√©orologiques et pour des raisons de s√©curit√©), l‚Äôorganisation se r√©serve le droit d‚Äôarr√™ter l‚Äô√©v√®nement en cours.
                    </p>
                    <p>
                        En cas d‚Äôannulation ou en cas d‚Äôinterruption de la course, pour quelque raison que ce soit, aucun remboursement d‚Äôinscription ne sera effectu√©.
                    </p>
                    <p>
                        En cas de mauvais temps, les repas seront servis √† l‚Äôint√©rieur du boulodrome.
                    </p>

                    <h4><strong>ARTICLE 9 - ACCEPTATION DU R√àGLEMENT</strong></h4>

                    La participation √† l‚Äô√©v√®nement implique l‚Äôacceptation, sans d√©rogation, par chaque concurrent de ce pr√©sent r√®glement.
                </div>
            </div>
        </div>
    </div>

    <div ng-if="vm.currentTimeslot" class="well challenge-well well-sm row">

        <div ng-if="vm.currentTimeslot.reserved">

            <form class="form-horizontal form-challenge form-challenge-static" ng-if="vm.currentTimeslot.reserved">
                <h4>Cr√©neau {{vm.currentTimeslot.payed ? "pay√©" : "r√©serv√©"}}
                    <span has-authority="ROLE_ADMIN" ng-if="!vm.currentTimeslot.payed"> le
                        {{vm.currentTimeslot.reservedDate | date:"dd/MM/yyyy"}}
                    </span>
                    par {{vm.currentTimeslot.user.displayName}}
                    <button type="button" ng-click="vm.eraseTimeslot()" has-authority="ROLE_ADMIN"
                            class="btn btn-danger btn-sm">
                        <span class="glyphicon glyphicon-remove-circle"></span>
                        Supprimer
                    </button>
                </h4>
                <div class="row">
                    <div class="col-sm-7">
                        <div class="form-group">
                            <label class="col-xs-3 control-label">D√©part</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.startTime}}</p></div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-3 control-label">N¬∞</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.line}}</p></div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-3 control-label">Nom d'√©quipe</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.teamName}}</p></div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-3 control-label">Capitaine</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.user.displayName}}</p></div>
                        </div>
                    </div>
                    <div class="col-sm-5">
                        <div class="form-group">
                            <label class="col-xs-3 control-label">Participant 1</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.swimmer1}}</p></div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-3 control-label">Participant 2</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.swimmer2}}</p></div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-3 control-label">Participant 3</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.swimmer3}}</p></div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-3 control-label">Participant 4</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.swimmer4}}</p></div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-3 control-label">Participant 5</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.swimmer5}}</p></div>
                        </div>
                    </div>
                </div>

            </form>

        </div>

        <div ng-if="!vm.currentTimeslot.reserved">
            <form name="editForm" role="form" class="form-horizontal form-challenge" novalidate show-validation>
                <h4>R√©servation de ce cr√©neau :</h4>
                <div ng-if="!vm.connected">
                    <form class="form-horizontal form-challenge form-challenge-static">
                        <div class="form-group">
                            <label class="col-xs-3 control-label">D√©part</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.startTime}}</p></div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-3 control-label">N¬∞</label>
                            <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.line}}</p></div>
                        </div>
                    </form>
                    <h2>
                        ‚ö† Pour continuer la r√©servation de ce cr√©neau, merci de bien vouloir vous
                        <a class="hand" ng-click="vm.goToLogin()">connecter</a>. ‚ö†
                    </h2>
                </div>
                <div ng-if="vm.connected">
                    <jh-alert-error></jh-alert-error>
                    <div class="form-group" ng-if="vm.isAuthenticated()">
                        <div class="row">
                            <div class="col-sm-7">
                                <form class="form-horizontal form-challenge form-challenge-static">
                                    <div class="form-group">
                                        <label class="col-xs-3 control-label">D√©part</label>
                                        <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.startTime}}</p></div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-xs-3 control-label">N¬∞</label>
                                        <div class="col-xs-9"><p class="form-control-static">{{vm.currentTimeslot.line}}</p></div>
                                    </div>
                                    <div class="form-group" has-authority="ROLE_ADMIN">
                                        <label class="col-xs-3 control-label">Capitaine</label>
                                        <div class="col-sm-4">
                                            <select class="form-control" ng-model="vm.userCreationType"
                                                    ng-options="userType as userType.label for userType in vm.userCreationTypes">
                                            </select>
                                        </div>
                                        <div class="col-sm-5">
                                            <p class="form-control-static" ng-if="vm.userCreationType === vm.userCreationTypes.CURRENT">
                                                {{vm.user.displayName}}
                                            </p>
                                            <div ng-if="vm.userCreationType === vm.userCreationTypes.NEW">
                                                <input type="text" class="form-control input-sm" placeholder="Nom de famille"
                                                       ng-model="vm.currentTimeslot.user.lastName"/>
                                                <input type="text" class="form-control input-sm" placeholder="Pr√©nom"
                                                       ng-model="vm.currentTimeslot.user.firstName"/>
                                                <input type="text" class="form-control input-sm" placeholder="E-mail"
                                                       ng-model="vm.currentTimeslot.user.email"/>
                                            </div>
                                            <select class="form-control" ng-model="vm.currentTimeslot.user"
                                                    ng-options="user as user.displayName for user in vm.users"
                                                    ng-if="vm.userCreationType === vm.userCreationTypes.EXISTING">
                                            </select>
                                        </div>
                                    </div>
                                </form>

                                <div class="text-center" style="margin-top:20px">
                                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="vm.currentTimeslot = undefined">
                                        <span class="glyphicon glyphicon-ban-circle"></span>&nbsp;<span>Annuler</span>
                                    </button>
                                    <button type="button" ng-disabled="editForm.$invalid || vm.isSaving" class="btn btn-primary" ng-click="vm.saveTimeslot()">
                                        <span class="glyphicon glyphicon-save"></span>&nbsp;<span>Sauvegarder</span>
                                    </button>
                                </div>
                            </div>
                            <div class="col-sm-5">
                                <form class="form-horizontal form-challenge">
                                    <div class="form-group">
                                        <label class="col-xs-3 control-label" for="field_teamName">Nom d'√©quipe</label>
                                        <div class="col-xs-9">
                                            <input type="text" class="form-control input-sm" name="teamName" id="field_teamName"
                                                   ng-model="vm.currentTimeslot.teamName"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-xs-3 control-label" for="field_swimmer1">Participant 1</label>
                                        <div class="col-xs-9">
                                            <input type="text" class="form-control input-sm" name="swimmer1" id="field_swimmer1"
                                                   ng-model="vm.currentTimeslot.swimmer1"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-xs-3 control-label" for="field_swimmer2">Participant 2</label>
                                        <div class="col-xs-9">
                                            <input type="text" class="form-control input-sm" name="swimmer2" id="field_swimmer2"
                                                   ng-model="vm.currentTimeslot.swimmer2"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-xs-3 control-label" for="field_swimmer3">Participant 3</label>
                                        <div class="col-xs-9">
                                            <input type="text" class="form-control input-sm" name="swimmer3" id="field_swimmer3"
                                                   ng-model="vm.currentTimeslot.swimmer3"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-xs-3 control-label" for="field_swimmer4">Participant 4</label>
                                        <div class="col-xs-9">
                                            <input type="text" class="form-control input-sm" name="swimmer4" id="field_swimmer4"
                                                   ng-model="vm.currentTimeslot.swimmer4"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-xs-3 control-label" for="field_swimmer5">Participant 5</label>
                                        <div class="col-xs-9">
                                            <input type="text" class="form-control input-sm" name="swimmer5" id="field_swimmer5"
                                                   ng-model="vm.currentTimeslot.swimmer5"/>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>

                    </div>

                </div>
            </form>
        </div>

    </div>
    <jh-alert></jh-alert>
    <div ng-repeat="(running, tbt) in vm.timeslotsByRunning">
        <h3 class="text-center">
            <div ng-if="running === 'true'">COUREURS : d√©parts de 08h00 √† 09h15</div>
            <div ng-if="running === 'false'">MARCHEURS : d√©parts de 09h30 √† 12h00</div>
        </h3>
        <table class="jh-table table challenge-table">
            <thead>
            <tr>
                <th></th>
                <th class="text-center" ng-repeat="(time, timeslots) in tbt.byTime">
                    {{time}}
                </th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="(line, timeslots) in tbt.byLine">
                <td style="width:70px">{{line}}</td>
                <td ng-repeat="timeslot in timeslots" class="text-right challenge-td {{vm.getClass(timeslot)}}"
                    data-tooltip="{{vm.getTooltip(timeslot)}}" data-tooltip-placement="top"
                    tooltip-append-to-body="true" ng-click="vm.clickOnTimeslot(timeslot)">
                    <span class="pull-left" style="font-size:large;" ng-if="!timeslot.running">üö∂</span>
                    <span class="pull-left" style="font-size:large;" ng-if="timeslot.running">üèÉ</span>
                    <span class="glyphicon glyphicon-user" ng-if="vm.user && timeslot.user.id===vm.user.id"></span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
